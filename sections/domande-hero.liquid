<!-- FABINDIA ROMA - FAQ ELITE SECTION -->
<!-- Versione Ultra Raffinata e Ottimizzata per UX/UI -->

<style>
  /* === RESET E CONTENIMENTO SEZIONE === */
  #shopify-section-{{ section.id }} {
    position: relative;
    overflow: hidden;
    background: {{ section.settings.background_color | default: '#FEFEFE' }};
  }

  /* === FUNZIONI BASE IMPLEMENTATE === */
  @media only screen and (min-width: 769px) {
    #shopify-section-{{ section.id }} {
      {%- if section.settings.max_dimensione != '100%' -%}
        max-width: {{ section.settings.max_dimensione }};
      {%- endif -%}
      margin: 0 auto;
      padding-top: {{ section.settings.padding_top_desktop }}px;
      padding-bottom: {{ section.settings.padding_bottom_desktop }}px;
      margin-top: {{ section.settings.margin_top_desktop }}px;
      margin-bottom: {{ section.settings.margin_bottom_desktop }}px;
    }
    
    {% if section.settings.nascondi_desktop %}
      #shopify-section-{{ section.id }} {
        display: none;
      }
    {% endif %}
  }

  @media only screen and (max-width: 768px) {
    #shopify-section-{{ section.id }} {
      padding-top: {{ section.settings.padding_top_mobile }}px;
      padding-bottom: {{ section.settings.padding_bottom_mobile }}px;
      margin-top: {{ section.settings.margin_top_mobile }}px;
      margin-bottom: {{ section.settings.margin_bottom_mobile }}px;
    }
    
    {% if section.settings.nascondi_mobile %}
      #shopify-section-{{ section.id }} {
        display: none;
      }
    {% endif %}
  }

  /* === BACKGROUND DECORATIVO === */
  #shopify-section-{{ section.id }} .fr-faq-background-pattern {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    opacity: {{ section.settings.pattern_opacity | divided_by: 100.0 }};
    pointer-events: none;
    z-index: 0;
  }

  #shopify-section-{{ section.id }} .fr-faq-background-pattern::before {
    content: '';
    position: absolute;
    top: -50%;
    right: -20%;
    width: 60%;
    height: 60%;
    background: radial-gradient(circle, {{ section.settings.accent_color | default: '#E5DDD5' }} 0%, transparent 70%);
    border-radius: 50%;
    filter: blur(100px);
  }

  #shopify-section-{{ section.id }} .fr-faq-background-pattern::after {
    content: '';
    position: absolute;
    bottom: -30%;
    left: -10%;
    width: 40%;
    height: 40%;
    background: radial-gradient(circle, {{ section.settings.secondary_accent | default: '#F0E6E0' }} 0%, transparent 70%);
    border-radius: 50%;
    filter: blur(80px);
  }

  /* === CONTAINER PRINCIPALE === */
  #shopify-section-{{ section.id }} .fr-faq-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
    position: relative;
    z-index: 1;
  }

  /* === HEADER ELEGANTE === */
  #shopify-section-{{ section.id }} .fr-faq-header {
    text-align: center;
    margin-bottom: {{ section.settings.header_spacing }}px;
    position: relative;
  }

  #shopify-section-{{ section.id }} .fr-faq-badge {
    display: inline-block;
    background: {{ section.settings.badge_bg | default: '#C33A32' }};
    color: {{ section.settings.badge_color | default: '#FFFFFF' }};
    padding: 6px 18px;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
    letter-spacing: 0.05em;
    text-transform: uppercase;
    margin-bottom: 20px;
    position: relative;
    overflow: hidden;
  }

  #shopify-section-{{ section.id }} .fr-faq-badge::after {
    content: '';
    position: absolute;
    top: 50%;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    animation: fr-shine 3s infinite;
  }

  @keyframes fr-shine {
    to {
      left: 100%;
    }
  }

  #shopify-section-{{ section.id }} .fr-faq-title {
    color: {{ section.settings.title_color | default: '#3E3E3E' }};
    font-family: var(--typeHeaderPrimary), serif;
    font-size: clamp(2rem, 4vw, 3rem);
    font-weight: 300;
    letter-spacing: -0.02em;
    line-height: 1.2;
    margin-bottom: 15px;
    position: relative;
  }

  #shopify-section-{{ section.id }} .fr-faq-title-accent {
    color: {{ section.settings.accent_text_color | default: '#C33A32' }};
    font-weight: 400;
  }

  #shopify-section-{{ section.id }} .fr-faq-subtitle {
    color: {{ section.settings.subtitle_color | default: '#3E3E3E' }};
    font-size: 1.125rem;
    line-height: 1.7;
    opacity: 0.8;
    max-width: 600px;
    margin: 0 auto;
  }

  /* === DECORAZIONE HEADER === */
  #shopify-section-{{ section.id }} .fr-faq-header-decoration {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    margin: 25px 0 40px;
  }

  #shopify-section-{{ section.id }} .fr-faq-header-line {
    width: 60px;
    height: 1px;
    background: linear-gradient(90deg, transparent, {{ section.settings.decoration_color | default: '#B5A397' }}, transparent);
  }

  #shopify-section-{{ section.id }} .fr-faq-header-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: {{ section.settings.decoration_color | default: '#B5A397' }};
  }

  /* === LAYOUT ACCORDION RAFFINATO === */
  #shopify-section-{{ section.id }} .fr-faq-accordion {
    max-width: {{ section.settings.accordion_max_width }}px;
    margin: 0 auto;
  }

  #shopify-section-{{ section.id }} .fr-faq-item {
    background: {{ section.settings.item_bg | default: '#FFFFFF' }};
    border: 1px solid {{ section.settings.item_border | default: '#E5DDD5' }};
    border-radius: {{ section.settings.item_radius }}px;
    margin-bottom: {{ section.settings.item_gap }}px;
    overflow: hidden;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  #shopify-section-{{ section.id }} .fr-faq-item:hover {
    border-color: {{ section.settings.item_hover_border | default: '#B5A397' }};
    box-shadow: 0 10px 40px rgba(0,0,0,0.08);
    transform: translateY(-2px);
  }

  #shopify-section-{{ section.id }} .fr-faq-item.fr-active {
    background: {{ section.settings.item_active_bg | default: '#FEFEFE' }};
    border-color: {{ section.settings.item_active_border | default: '#C33A32' }};
  }

  /* === QUESTION HEADER === */
  #shopify-section-{{ section.id }} .fr-faq-question-wrapper {
    padding: {{ section.settings.question_padding }}px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 20px;
    position: relative;
    user-select: none;
    transition: background-color 0.3s ease;
  }
  
  #shopify-section-{{ section.id }} .fr-faq-accordion .fr-faq-question-wrapper:hover {
    background-color: rgba(0,0,0,0.02);
  }

  #shopify-section-{{ section.id }} .fr-faq-question-content {
    flex: 1;
    display: flex;
    align-items: center;
    gap: 20px;
  }

  /* === NUMERO ELEGANTE === */
  #shopify-section-{{ section.id }} .fr-faq-number {
    flex-shrink: 0;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: {{ section.settings.number_bg | default: '#F0E6E0' }};
    color: {{ section.settings.number_color | default: '#C33A32' }};
    border-radius: 50%;
    font-weight: 500;
    font-size: 0.875rem;
    transition: all 0.3s ease;
  }

  #shopify-section-{{ section.id }} .fr-faq-item.fr-active .fr-faq-number {
    background: {{ section.settings.number_active_bg | default: '#C33A32' }};
    color: {{ section.settings.number_active_color | default: '#FFFFFF' }};
    transform: scale(1.1);
  }

  /* === QUESTION TEXT === */
  #shopify-section-{{ section.id }} .fr-faq-question {
    flex: 1;
    color: {{ section.settings.question_color | default: '#3E3E3E' }};
    font-size: {{ section.settings.question_size }}rem;
    font-weight: {{ section.settings.question_weight }};
    line-height: 1.5;
    transition: color 0.3s ease;
  }

  #shopify-section-{{ section.id }} .fr-faq-item.fr-active .fr-faq-question {
    color: {{ section.settings.question_active_color | default: '#C33A32' }};
  }

  /* === TOGGLE ICON === */
  #shopify-section-{{ section.id }} .fr-faq-toggle {
    flex-shrink: 0;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
  }

  #shopify-section-{{ section.id }} .fr-faq-toggle::before,
  #shopify-section-{{ section.id }} .fr-faq-toggle::after {
    content: '';
    position: absolute;
    background: {{ section.settings.toggle_color | default: '#B5A397' }};
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  #shopify-section-{{ section.id }} .fr-faq-toggle::before {
    width: 18px;
    height: 2px;
  }

  #shopify-section-{{ section.id }} .fr-faq-toggle::after {
    width: 2px;
    height: 18px;
  }

  #shopify-section-{{ section.id }} .fr-faq-item.fr-active .fr-faq-toggle::after {
    transform: rotate(90deg);
    opacity: 0;
  }

  #shopify-section-{{ section.id }} .fr-faq-item.fr-active .fr-faq-toggle::before {
    background: {{ section.settings.toggle_active_color | default: '#C33A32' }};
  }

  /* === ANSWER CONTAINER === */
  #shopify-section-{{ section.id }} .fr-faq-answer-wrapper {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  }

  #shopify-section-{{ section.id }} .fr-faq-item.fr-active .fr-faq-answer-wrapper {
    max-height: 2000px;
  }

  #shopify-section-{{ section.id }} .fr-faq-answer {
    padding: 0 {{ section.settings.answer_padding }}px {{ section.settings.answer_padding }}px;
    color: {{ section.settings.answer_color | default: '#3E3E3E' }};
    font-size: {{ section.settings.answer_size }}rem;
    line-height: 1.8;
  }
  
  #shopify-section-{{ section.id }} .fr-faq-item.fr-active .fr-faq-answer {
    opacity: 0;
    transform: translateY(-10px);
    animation: fr-fadeInAnswer 0.5s ease forwards;
    animation-delay: 0.1s;
  }

  @keyframes fr-fadeInAnswer {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  #shopify-section-{{ section.id }} .fr-faq-answer p {
    margin-bottom: 1rem;
  }

  #shopify-section-{{ section.id }} .fr-faq-answer p:last-child {
    margin-bottom: 0;
  }

  /* === HIGHLIGHTED TEXT === */
  #shopify-section-{{ section.id }} .fr-faq-highlight {
    color: {{ section.settings.highlight_color | default: '#C33A32' }};
    font-weight: 500;
    position: relative;
  }

  #shopify-section-{{ section.id }} .fr-faq-highlight::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background: {{ section.settings.highlight_underline | default: '#F0E6E0' }};
    transform: scaleX(0);
    transform-origin: left;
    transition: transform 0.3s ease;
  }

  #shopify-section-{{ section.id }} .fr-faq-item.fr-active .fr-faq-highlight::after {
    transform: scaleX(1);
  }

  /* === FOOTER CTA === */
  #shopify-section-{{ section.id }} .fr-faq-footer {
    text-align: center;
    margin-top: {{ section.settings.footer_spacing }}px;
  }

  #shopify-section-{{ section.id }} .fr-faq-cta-wrapper {
    display: inline-flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
  }

  #shopify-section-{{ section.id }} .fr-faq-cta-text {
    color: {{ section.settings.cta_text_color | default: '#3E3E3E' }};
    font-size: 1rem;
    opacity: 0.8;
  }

  #shopify-section-{{ section.id }} .fr-faq-btn {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    background: {{ section.settings.btn_bg | default: '#C33A32' }};
    color: {{ section.settings.btn_color | default: '#FFFFFF' }};
    padding: 14px 35px;
    border-radius: 30px;
    text-decoration: none;
    font-weight: 500;
    font-size: 0.95rem;
    letter-spacing: 0.02em;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
  }

  #shopify-section-{{ section.id }} .fr-faq-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
    transition: left 0.5s ease;
  }

  #shopify-section-{{ section.id }} .fr-faq-btn:hover {
    background: {{ section.settings.btn_hover_bg | default: '#A02E28' }};
    transform: translateY(-2px);
    box-shadow: 0 10px 30px rgba(195, 58, 50, 0.3);
  }

  #shopify-section-{{ section.id }} .fr-faq-btn:hover::before {
    left: 100%;
  }

  #shopify-section-{{ section.id }} .fr-faq-btn-icon {
    transition: transform 0.3s ease;
  }

  #shopify-section-{{ section.id }} .fr-faq-btn:hover .fr-faq-btn-icon {
    transform: translateX(3px);
  }

  /* === GRID LAYOUT === */
  #shopify-section-{{ section.id }} .fr-faq-grid {
    display: grid;
    grid-template-columns: repeat({{ section.settings.grid_columns }}, 1fr);
    gap: {{ section.settings.grid_gap }}px;
  }

  #shopify-section-{{ section.id }} .fr-faq-grid .fr-faq-item {
    margin-bottom: 0;
    position: relative;
  }

  #shopify-section-{{ section.id }} .fr-faq-grid .fr-faq-item.fr-has-link {
    cursor: pointer;
    transition: all 0.3s ease;
    background: {{ section.settings.item_bg | default: '#FFFFFF' }};
  }

  #shopify-section-{{ section.id }} .fr-faq-grid .fr-faq-item.fr-has-link:hover {
    transform: translateY(-5px) scale(1.02);
    box-shadow: 0 20px 50px rgba(0,0,0,0.15);
    border-color: {{ section.settings.item_active_border | default: '#C33A32' }};
    background: {{ section.settings.item_active_bg | default: '#FEFEFE' }};
  }

  #shopify-section-{{ section.id }} .fr-faq-grid .fr-faq-item.fr-has-link .fr-faq-link-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 1;
  }

  #shopify-section-{{ section.id }} .fr-faq-grid .fr-faq-item.fr-has-link .fr-faq-number {
    background: {{ section.settings.number_active_bg | default: '#C33A32' }};
    color: {{ section.settings.number_active_color | default: '#FFFFFF' }};
  }

  #shopify-section-{{ section.id }} .fr-faq-grid .fr-faq-item.fr-has-link .fr-faq-question {
    color: {{ section.settings.question_color | default: '#3E3E3E' }};
    transition: color 0.3s ease;
  }
  
  #shopify-section-{{ section.id }} .fr-faq-grid .fr-faq-item.fr-has-link:hover .fr-faq-question {
    color: {{ section.settings.question_active_color | default: '#C33A32' }};
  }

  #shopify-section-{{ section.id }} .fr-faq-grid .fr-faq-item.fr-has-link::after {
    content: '→';
    position: absolute;
    top: {{ section.settings.question_padding }}px;
    right: {{ section.settings.question_padding }}px;
    color: {{ section.settings.question_active_color | default: '#C33A32' }};
    font-size: 1.5rem;
    opacity: 0.7;
    transition: all 0.3s ease;
  }

  #shopify-section-{{ section.id }} .fr-faq-grid .fr-faq-item.fr-has-link:hover::after {
    transform: translateX(5px);
    opacity: 1;
  }

  #shopify-section-{{ section.id }} .fr-faq-grid .fr-faq-question-wrapper {
    flex-direction: column;
    align-items: flex-start;
    text-align: left;
    position: relative;
    z-index: 2;
    pointer-events: none;
  }

  #shopify-section-{{ section.id }} .fr-faq-grid .fr-faq-toggle {
    display: none;
  }

  #shopify-section-{{ section.id }} .fr-faq-grid .fr-faq-answer-wrapper {
    max-height: none;
    position: relative;
    z-index: 2;
    pointer-events: none;
  }

  #shopify-section-{{ section.id }} .fr-faq-grid .fr-faq-answer {
    opacity: 1;
    transform: none;
    animation: none;
  }

  /* === STATS SECTION === */
  #shopify-section-{{ section.id }} .fr-faq-stats {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 30px;
    margin-top: 50px;
    padding: 30px;
    background: {{ section.settings.stats_bg | default: '#F0E6E0' }};
    border-radius: 15px;
  }

  #shopify-section-{{ section.id }} .fr-faq-stat {
    text-align: center;
  }

  #shopify-section-{{ section.id }} .fr-faq-stat-number {
    font-size: 2rem;
    font-weight: 300;
    color: {{ section.settings.stat_number_color | default: '#C33A32' }};
    margin-bottom: 5px;
  }

  #shopify-section-{{ section.id }} .fr-faq-stat-label {
    font-size: 0.875rem;
    color: {{ section.settings.stat_label_color | default: '#3E3E3E' }};
    opacity: 0.7;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  /* === ANIMATIONS === */
  #shopify-section-{{ section.id }} [data-aos] {
    opacity: 0;
    transform: translateY(20px);
    transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  }

  #shopify-section-{{ section.id }} [data-aos].aos-animate {
    opacity: 1;
    transform: translateY(0);
  }

  #shopify-section-{{ section.id }} [data-aos-delay="100"] {
    transition-delay: 0.1s;
  }

  #shopify-section-{{ section.id }} [data-aos-delay="200"] {
    transition-delay: 0.2s;
  }

  #shopify-section-{{ section.id }} [data-aos-delay="300"] {
    transition-delay: 0.3s;
  }

  /* === RESPONSIVE === */
  @media only screen and (max-width: 768px) {
    #shopify-section-{{ section.id }} .fr-faq-title {
      font-size: clamp(1.75rem, 6vw, 2.5rem);
    }

    #shopify-section-{{ section.id }} .fr-faq-subtitle {
      font-size: 1rem;
    }

    #shopify-section-{{ section.id }} .fr-faq-accordion {
      max-width: 100%;
    }

    #shopify-section-{{ section.id }} .fr-faq-question-wrapper {
      padding: {{ section.settings.question_padding_mobile }}px;
    }

    #shopify-section-{{ section.id }} .fr-faq-question {
      font-size: {{ section.settings.question_size_mobile }}rem;
    }

    #shopify-section-{{ section.id }} .fr-faq-answer {
      padding: 0 {{ section.settings.answer_padding_mobile }}px {{ section.settings.answer_padding_mobile }}px;
      font-size: {{ section.settings.answer_size_mobile }}rem;
    }

    #shopify-section-{{ section.id }} .fr-faq-grid {
      grid-template-columns: 1fr;
    }

    #shopify-section-{{ section.id }} .fr-faq-stats {
      grid-template-columns: 1fr;
      gap: 20px;
    }

    #shopify-section-{{ section.id }} .fr-faq-number {
      width: 35px;
      height: 35px;
      font-size: 0.8rem;
    }

    #shopify-section-{{ section.id }} .fr-faq-toggle {
      width: 28px;
      height: 28px;
    }

    #shopify-section-{{ section.id }} .fr-faq-btn {
      padding: 12px 28px;
      font-size: 0.9rem;
    }
  }
</style>

<div class="fr-faq-elite-section" data-section-id="{{ section.id }}">
  <!-- Background Pattern -->
  {%- if section.settings.enable_pattern -%}
    <div class="fr-faq-background-pattern"></div>
  {%- endif -%}

  <div class="fr-faq-container">
    <!-- Header -->
    <div class="fr-faq-header" data-aos>
      {%- if section.settings.show_badge and section.settings.badge_text != blank -%}
        <span class="fr-faq-badge">{{ section.settings.badge_text }}</span>
      {%- endif -%}
      
      <h2 class="fr-faq-title">
        {{ section.settings.title_prefix }}
        {%- if section.settings.title_accent != blank -%}
          <span class="fr-faq-title-accent">{{ section.settings.title_accent }}</span>
        {%- endif -%}
        {{ section.settings.title_suffix }}
      </h2>
      
      {%- if section.settings.subtitle != blank -%}
        <p class="fr-faq-subtitle">{{ section.settings.subtitle }}</p>
      {%- endif -%}
      
      {%- if section.settings.show_decoration -%}
        <div class="fr-faq-header-decoration">
          <span class="fr-faq-header-line"></span>
          <span class="fr-faq-header-dot"></span>
          <span class="fr-faq-header-line"></span>
        </div>
      {%- endif -%}
    </div>

    <!-- FAQ Items -->
    <div class="fr-faq-{{ section.settings.layout_type }}">
      {%- for block in section.blocks -%}
        {%- case block.type -%}
          {%- when 'faq' -%}
            <div class="fr-faq-item {% if section.settings.layout_type == 'grid' and block.settings.link_url != blank %}fr-has-link{% endif %}" data-aos data-aos-delay="{{ forloop.index | times: 100 }}" {{ block.shopify_attributes }}>
              {%- if section.settings.layout_type == 'grid' and block.settings.link_url != blank -%}
                <a href="{{ block.settings.link_url }}" class="fr-faq-link-overlay" aria-label="{{ block.settings.question }}"></a>
              {%- endif -%}
              <div class="fr-faq-question-wrapper">
                <div class="fr-faq-question-content">
                  {%- if section.settings.show_numbers -%}
                    <span class="fr-faq-number">{{ forloop.index | prepend: '0' | slice: -2, 2 }}</span>
                  {%- endif -%}
                  <h3 class="fr-faq-question">{{ block.settings.question }}</h3>
                </div>
                {%- if section.settings.layout_type == 'accordion' -%}
                  <div class="fr-faq-toggle"></div>
                {%- endif -%}
              </div>
              <div class="fr-faq-answer-wrapper">
                <div class="fr-faq-answer">
                  {{ block.settings.answer }}
                  {%- if section.settings.layout_type == 'accordion' and block.settings.link_text != blank and block.settings.link_url != blank -%}
                    <p><a href="{{ block.settings.link_url }}" class="fr-faq-highlight">{{ block.settings.link_text }}</a></p>
                  {%- endif -%}
                </div>
              </div>
            </div>
        {%- endcase -%}
      {%- endfor -%}
    </div>

    <!-- Stats Section -->
    {%- if section.settings.show_stats -%}
      <div class="fr-faq-stats" data-aos>
        <div class="fr-faq-stat">
          <div class="fr-faq-stat-number">{{ section.settings.stat1_number }}</div>
          <div class="fr-faq-stat-label">{{ section.settings.stat1_label }}</div>
        </div>
        <div class="fr-faq-stat">
          <div class="fr-faq-stat-number">{{ section.settings.stat2_number }}</div>
          <div class="fr-faq-stat-label">{{ section.settings.stat2_label }}</div>
        </div>
        <div class="fr-faq-stat">
          <div class="fr-faq-stat-number">{{ section.settings.stat3_number }}</div>
          <div class="fr-faq-stat-label">{{ section.settings.stat3_label }}</div>
        </div>
      </div>
    {%- endif -%}

    <!-- Footer CTA -->
    {%- if section.settings.show_cta -%}
      <div class="fr-faq-footer" data-aos>
        <div class="fr-faq-cta-wrapper">
          {%- if section.settings.cta_text != blank -%}
            <p class="fr-faq-cta-text">{{ section.settings.cta_text }}</p>
          {%- endif -%}
          <a href="{{ section.settings.cta_link | default: '#' }}" class="fr-faq-btn">
            {{ section.settings.cta_button_text }}
            <span class="fr-faq-btn-icon">→</span>
          </a>
        </div>
      </div>
    {%- endif -%}
  </div>
</div>

<script>
(function() {
  'use strict';
  
  function initFaqElite{{ section.id | replace: '-', '_' }}() {
    const sectionEl = document.querySelector('[data-section-id="{{ section.id }}"]');
    if (!sectionEl) return;

    // Accordion functionality
    {%- if section.settings.layout_type == 'accordion' -%}
    const accordionContainer = sectionEl.querySelector('.fr-faq-accordion');
    if (accordionContainer) {
      const items = accordionContainer.querySelectorAll('.fr-faq-item');
      
      items.forEach((item) => {
        const questionWrapper = item.querySelector('.fr-faq-question-wrapper');
        
        if (questionWrapper) {
          questionWrapper.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            
            const isActive = item.classList.contains('fr-active');
            
            // Close all items
            items.forEach(i => i.classList.remove('fr-active'));
            
            // Toggle current item
            if (!isActive) {
              item.classList.add('fr-active');
            }
          });
        }
      });
      
      // Open first item by default if setting enabled
      {%- if section.settings.open_first -%}
        if (items.length > 0) {
          items[0].classList.add('fr-active');
        }
      {%- endif -%}
    }
    {%- endif -%}

    // AOS Animation
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('aos-animate');
          observer.unobserve(entry.target);
        }
      });
    }, observerOptions);

    const animatedElements = sectionEl.querySelectorAll('[data-aos]');
    animatedElements.forEach(el => observer.observe(el));
  }

  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initFaqElite{{ section.id | replace: '-', '_' }});
  } else {
    initFaqElite{{ section.id | replace: '-', '_' }}();
  }
})();
</script>

<!-- Schema Markup per SEO -->
{%- if section.settings.enable_schema -%}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {%- assign faq_count = 0 -%}
    {%- for block in section.blocks -%}
      {%- if block.type == 'faq' -%}
        {%- assign faq_count = faq_count | plus: 1 -%}
        {
          "@type": "Question",
          "name": {{ block.settings.question | json }},
          "acceptedAnswer": {
            "@type": "Answer",
            "text": {{ block.settings.answer | strip_html | json }}
          }
        }{%- unless forloop.last -%},{%- endunless -%}
      {%- endif -%}
    {%- endfor -%}
  ]
}
</script>
{%- endif -%}

{% schema %}
{
  "name": "FAQ Elite",
  "settings": [
    {
      "type": "header",
      "content": "📝 Contenuti"
    },
    {
      "type": "checkbox",
      "id": "show_badge",
      "label": "Mostra badge",
      "default": true
    },
    {
      "type": "text",
      "id": "badge_text",
      "label": "Testo badge",
      "default": "FAQ"
    },
    {
      "type": "text",
      "id": "title_prefix",
      "label": "Titolo prefisso",
      "default": "Domande"
    },
    {
      "type": "text",
      "id": "title_accent",
      "label": "Titolo accento",
      "default": "Frequenti"
    },
    {
      "type": "text",
      "id": "title_suffix",
      "label": "Titolo suffisso"
    },
    {
      "type": "textarea",
      "id": "subtitle",
      "label": "Sottotitolo",
      "default": "Trova le risposte alle domande più comuni"
    },
    {
      "type": "checkbox",
      "id": "show_decoration",
      "label": "Mostra decorazione",
      "default": true
    },
    {
      "type": "header",
      "content": "🎨 Layout"
    },
    {
      "type": "select",
      "id": "layout_type",
      "label": "Tipo layout",
      "options": [
        {
          "value": "accordion",
          "label": "Accordion"
        },
        {
          "value": "grid",
          "label": "Griglia"
        }
      ],
      "default": "accordion"
    },
    {
      "type": "range",
      "id": "accordion_max_width",
      "label": "Larghezza accordion",
      "min": 600,
      "max": 1000,
      "step": 50,
      "default": 800,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "grid_columns",
      "label": "Colonne griglia",
      "min": 1,
      "max": 3,
      "step": 1,
      "default": 2
    },
    {
      "type": "range",
      "id": "grid_gap",
      "label": "Spazio griglia",
      "min": 20,
      "max": 50,
      "step": 5,
      "default": 30,
      "unit": "px"
    },
    {
      "type": "checkbox",
      "id": "show_numbers",
      "label": "Mostra numeri",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "open_first",
      "label": "Apri primo elemento",
      "default": false
    },
    {
      "type": "header",
      "content": "🎨 Stile Elementi"
    },
    {
      "type": "range",
      "id": "item_radius",
      "label": "Raggio bordi",
      "min": 0,
      "max": 20,
      "step": 2,
      "default": 12,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "item_gap",
      "label": "Spazio tra elementi",
      "min": 10,
      "max": 30,
      "step": 2,
      "default": 16,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "header_spacing",
      "label": "Spazio header",
      "min": 30,
      "max": 80,
      "step": 5,
      "default": 50,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "footer_spacing",
      "label": "Spazio footer",
      "min": 30,
      "max": 80,
      "step": 5,
      "default": 60,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "📏 Dimensioni Testi"
    },
    {
      "type": "range",
      "id": "question_size",
      "label": "Dimensione domande",
      "min": 0.9,
      "max": 1.5,
      "step": 0.1,
      "default": 1.1
    },
    {
      "type": "range",
      "id": "question_size_mobile",
      "label": "Domande mobile",
      "min": 0.8,
      "max": 1.2,
      "step": 0.1,
      "default": 1
    },
    {
      "type": "select",
      "id": "question_weight",
      "label": "Peso domande",
      "options": [
        {
          "value": "400",
          "label": "Normale"
        },
        {
          "value": "500",
          "label": "Medium"
        },
        {
          "value": "600",
          "label": "Semi-bold"
        }
      ],
      "default": "500"
    },
    {
      "type": "range",
      "id": "answer_size",
      "label": "Dimensione risposte",
      "min": 0.8,
      "max": 1.2,
      "step": 0.1,
      "default": 1
    },
    {
      "type": "range",
      "id": "answer_size_mobile",
      "label": "Risposte mobile",
      "min": 0.8,
      "max": 1.1,
      "step": 0.1,
      "default": 0.9
    },
    {
      "type": "header",
      "content": "📐 Padding"
    },
    {
      "type": "range",
      "id": "question_padding",
      "label": "Padding domande",
      "min": 15,
      "max": 35,
      "step": 5,
      "default": 25,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "question_padding_mobile",
      "label": "Padding mobile",
      "min": 12,
      "max": 25,
      "step": 1,
      "default": 18,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "answer_padding",
      "label": "Padding risposte",
      "min": 15,
      "max": 35,
      "step": 5,
      "default": 25,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "answer_padding_mobile",
      "label": "Padding mobile",
      "min": 12,
      "max": 25,
      "step": 1,
      "default": 18,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "🎨 Colori"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Sfondo sezione",
      "default": "#FEFEFE"
    },
    {
      "type": "color",
      "id": "accent_color",
      "label": "Colore accento",
      "default": "#E5DDD5"
    },
    {
      "type": "color",
      "id": "secondary_accent",
      "label": "Accento secondario",
      "default": "#F0E6E0"
    },
    {
      "type": "color",
      "id": "badge_bg",
      "label": "Sfondo badge",
      "default": "#C33A32"
    },
    {
      "type": "color",
      "id": "badge_color",
      "label": "Colore badge",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Colore titolo",
      "default": "#3E3E3E"
    },
    {
      "type": "color",
      "id": "accent_text_color",
      "label": "Colore accento testo",
      "default": "#C33A32"
    },
    {
      "type": "color",
      "id": "subtitle_color",
      "label": "Colore sottotitolo",
      "default": "#3E3E3E"
    },
    {
      "type": "color",
      "id": "decoration_color",
      "label": "Colore decorazione",
      "default": "#B5A397"
    },
    {
      "type": "color",
      "id": "item_bg",
      "label": "Sfondo elemento",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "item_border",
      "label": "Bordo elemento",
      "default": "#E5DDD5"
    },
    {
      "type": "color",
      "id": "item_hover_border",
      "label": "Bordo hover",
      "default": "#B5A397"
    },
    {
      "type": "color",
      "id": "item_active_bg",
      "label": "Sfondo attivo",
      "default": "#FEFEFE"
    },
    {
      "type": "color",
      "id": "item_active_border",
      "label": "Bordo attivo",
      "default": "#C33A32"
    },
    {
      "type": "color",
      "id": "number_bg",
      "label": "Sfondo numero",
      "default": "#F0E6E0"
    },
    {
      "type": "color",
      "id": "number_color",
      "label": "Colore numero",
      "default": "#C33A32"
    },
    {
      "type": "color",
      "id": "number_active_bg",
      "label": "Sfondo numero attivo",
      "default": "#C33A32"
    },
    {
      "type": "color",
      "id": "number_active_color",
      "label": "Colore numero attivo",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "question_color",
      "label": "Colore domande",
      "default": "#3E3E3E"
    },
    {
      "type": "color",
      "id": "question_active_color",
      "label": "Colore domande attive",
      "default": "#C33A32"
    },
    {
      "type": "color",
      "id": "answer_color",
      "label": "Colore risposte",
      "default": "#3E3E3E"
    },
    {
      "type": "color",
      "id": "toggle_color",
      "label": "Colore toggle",
      "default": "#B5A397"
    },
    {
      "type": "color",
      "id": "toggle_active_color",
      "label": "Toggle attivo",
      "default": "#C33A32"
    },
    {
      "type": "color",
      "id": "highlight_color",
      "label": "Colore evidenza",
      "default": "#C33A32"
    },
    {
      "type": "color",
      "id": "highlight_underline",
      "label": "Sottolineatura",
      "default": "#F0E6E0"
    },
    {
      "type": "header",
      "content": "📊 Statistiche"
    },
    {
      "type": "checkbox",
      "id": "show_stats",
      "label": "Mostra statistiche",
      "default": false
    },
    {
      "type": "color",
      "id": "stats_bg",
      "label": "Sfondo stats",
      "default": "#F0E6E0"
    },
    {
      "type": "color",
      "id": "stat_number_color",
      "label": "Colore numeri",
      "default": "#C33A32"
    },
    {
      "type": "color",
      "id": "stat_label_color",
      "label": "Colore etichette",
      "default": "#3E3E3E"
    },
    {
      "type": "text",
      "id": "stat1_number",
      "label": "Numero 1",
      "default": "100+"
    },
    {
      "type": "text",
      "id": "stat1_label",
      "label": "Etichetta 1",
      "default": "Clienti soddisfatti"
    },
    {
      "type": "text",
      "id": "stat2_number",
      "label": "Numero 2",
      "default": "24h"
    },
    {
      "type": "text",
      "id": "stat2_label",
      "label": "Etichetta 2",
      "default": "Risposta garantita"
    },
    {
      "type": "text",
      "id": "stat3_number",
      "label": "Numero 3",
      "default": "98%"
    },
    {
      "type": "text",
      "id": "stat3_label",
      "label": "Etichetta 3",
      "default": "Tasso soddisfazione"
    },
    {
      "type": "header",
      "content": "🔘 Call to Action"
    },
    {
      "type": "checkbox",
      "id": "show_cta",
      "label": "Mostra CTA",
      "default": true
    },
    {
      "type": "textarea",
      "id": "cta_text",
      "label": "Testo CTA",
      "default": "Non hai trovato la risposta?"
    },
    {
      "type": "text",
      "id": "cta_button_text",
      "label": "Testo pulsante",
      "default": "Contattaci"
    },
    {
      "type": "url",
      "id": "cta_link",
      "label": "Link CTA"
    },
    {
      "type": "color",
      "id": "cta_text_color",
      "label": "Colore testo CTA",
      "default": "#3E3E3E"
    },
    {
      "type": "color",
      "id": "btn_bg",
      "label": "Sfondo pulsante",
      "default": "#C33A32"
    },
    {
      "type": "color",
      "id": "btn_color",
      "label": "Colore pulsante",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "btn_hover_bg",
      "label": "Sfondo hover",
      "default": "#A02E28"
    },
    {
      "type": "header",
      "content": "✨ Effetti"
    },
    {
      "type": "checkbox",
      "id": "enable_pattern",
      "label": "Pattern sfondo",
      "default": true
    },
    {
      "type": "range",
      "id": "pattern_opacity",
      "label": "Opacità pattern",
      "min": 10,
      "max": 100,
      "step": 10,
      "default": 30,
      "unit": "%"
    },
    {
      "type": "header",
      "content": "🔍 SEO"
    },
    {
      "type": "checkbox",
      "id": "enable_schema",
      "label": "Abilita Schema.org",
      "default": true,
      "info": "Aggiunge markup FAQ per SEO"
    },
    {
      "type": "checkbox",
      "id": "nascondi_mobile",
      "label": "Nascondi da Mobile",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "nascondi_desktop",
      "label": "Nascondi da Desktop",
      "default": false
    },
    {
      "type": "range",
      "id": "padding_top_mobile",
      "label": "Padding Top Mobile",
      "default": 30,
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom_mobile",
      "label": "Padding Bottom Mobile",
      "default": 30,
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_top_desktop",
      "label": "Padding Top Desktop",
      "default": 60,
      "min": 0,
      "max": 200,
      "step": 2,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom_desktop",
      "label": "Padding Bottom Desktop",
      "default": 60,
      "min": 0,
      "max": 200,
      "step": 2,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "margin_top_mobile",
      "label": "Margin Top Mobile",
      "default": 0,
      "min": -100,
      "max": 100,
      "step": 2,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "margin_bottom_mobile",
      "label": "Margin Bottom Mobile",
      "default": 0,
      "min": -100,
      "max": 100,
      "step": 2,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "margin_top_desktop",
      "label": "Margin Top Desktop",
      "default": 0,
      "min": -200,
      "max": 200,
      "step": 4,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "margin_bottom_desktop",
      "label": "Margin Bottom Desktop",
      "default": 0,
      "min": -200,
      "max": 200,
      "step": 4,
      "unit": "px"
    },
    {
      "type": "select",
      "id": "max_dimensione",
      "label": "Larghezza Max Desktop",
      "options": [
        {
          "value": "100%",
          "label": "100%"
        },
        {
          "value": "1400px",
          "label": "1400px"
        },
        {
          "value": "1300px",
          "label": "1300px"
        },
        {
          "value": "1200px",
          "label": "1200px"
        },
        {
          "value": "1100px",
          "label": "1100px"
        },
        {
          "value": "1000px",
          "label": "1000px"
        },
        {
          "value": "900px",
          "label": "900px"
        },
        {
          "value": "800px",
          "label": "800px"
        },
        {
          "value": "700px",
          "label": "700px"
        }
      ],
      "default": "1200px"
    }
  ],
  "blocks": [
    {
      "type": "faq",
      "name": "Domanda FAQ",
      "settings": [
        {
          "type": "text",
          "id": "question",
          "label": "Domanda",
          "default": "Qual è la vostra politica di reso?"
        },
        {
          "type": "richtext",
          "id": "answer",
          "label": "Risposta",
          "default": "<p>Offriamo resi gratuiti entro 30 giorni dall'acquisto. I prodotti devono essere nelle condizioni originali con tutti i tag attaccati.</p>"
        },
        {
          "type": "text",
          "id": "link_text",
          "label": "Testo link (accordion)",
          "info": "Visibile solo in modalità accordion"
        },
        {
          "type": "url",
          "id": "link_url",
          "label": "URL link",
          "info": "In griglia: rende tutto il blocco cliccabile. In accordion: crea un link nel testo"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "FAQ Elite",
      "category": "Fabindia custom",
      "blocks": [
        {
          "type": "faq",
          "settings": {
            "question": "Come posso tracciare il mio ordine?",
            "answer": "<p>Dopo la spedizione, riceverai un'email con il numero di tracking. Puoi utilizzarlo per monitorare il tuo ordine in tempo reale.</p>"
          }
        },
        {
          "type": "faq",
          "settings": {
            "question": "Quali metodi di pagamento accettate?",
            "answer": "<p>Accettiamo tutte le principali carte di credito, PayPal, Apple Pay e bonifico bancario. Tutti i pagamenti sono processati in modo sicuro.</p>"
          }
        },
        {
          "type": "faq",
          "settings": {
            "question": "Quanto tempo ci vuole per la consegna?",
            "answer": "<p>La consegna standard richiede 3-5 giorni lavorativi. Offriamo anche spedizione express in 24-48 ore per ordini urgenti.</p>"
          }
        }
      ]
    }
  ]
}
{% endschema %}